2025-06-08 13:13:17,751 - api.tasks - INFO - tasks - process_session_pdf - 2844 - 📥 Downloading PDF from: https://record.assembly.go.kr/assembly/viewer/minutes/download/pdf.do?id=54810
2025-06-08 13:13:26,611 - api.tasks - INFO - tasks - process_session_pdf - 2858 - 📥 PDF for session 54810 downloaded to temp_files/session_54810_1749388398.pdf
2025-06-08 13:13:26,648 - api.tasks - INFO - tasks - process_session_pdf - 2872 - Extracting text from 46 pages in PDF for session 54810...
2025-06-08 13:13:29,592 - api.tasks - INFO - tasks - process_session_pdf - 2881 - Processed 20/46 pages...
2025-06-08 13:13:31,993 - api.tasks - INFO - tasks - process_session_pdf - 2881 - Processed 40/46 pages...
2025-06-08 13:13:32,945 - api.tasks - INFO - tasks - process_session_pdf - 2882 - 📄 Extracted ~54285 chars from PDF for session 54810.
2025-06-08 13:13:33,079 - api.tasks - INFO - tasks - process_session_pdf - 2906 - Bills context for session 54810 LLM: 94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 2208268), 93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509), 92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안번호 2203760), 91. 폐기물관리법 일부개정법률안(대...
2025-06-08 13:13:33,079 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3146 - 🧹 Cleaning PDF text for session 54810
2025-06-08 13:13:33,090 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3148 - 📄 Cleaned text length: ~54284 chars
2025-06-08 13:13:33,090 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3150 - 🤖 Starting LLM-based statement processing for session PDF 54810.
2025-06-08 13:13:33,091 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3171 - 🔍 Stage 0 (Bill Segment): Attempting to segment transcript by bills for session 54810
2025-06-08 13:13:33,091 - api.tasks - ERROR - tasks - process_pdf_text_for_statements - 3205 - Error during LLM bill segmentation: name '_process_bill_segmentation_with_batching' is not defined. Using bill names for fallback segmentation.
2025-06-08 13:13:33,091 - api.tasks - ERROR - tasks - process_pdf_text_for_statements - 3208 - Traceback for bill segmentation error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3186, in process_pdf_text_for_statements
    bill_segments_from_llm = _process_bill_segmentation_with_batching(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
NameError: name '_process_bill_segmentation_with_batching' is not defined. Did you mean: '_process_single_segmentation_batch'?
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3219 - Created 94 fallback segments with actual bill names
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3254 - Successfully ordered 94 bill segments by appearance.
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3259 - Processing 94 identified bill text segments...
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 2208268) (577 chars) ---
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 2208268)' (session: 54810) - 577 chars
2025-06-08 13:13:33,103 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 22...' (577 chars)
2025-06-08 13:13:33,597 - api.tasks - WARNING - tasks - _process_text_chunk_for_segmentation - 1902 - Response doesn't contain JSON array: 이 회의록 텍스트에서는 발언자의 발언 구간을 식별할 수 있는 정보가 제공되지 않았습니다. 따라서 JSON 형식으로 응답할 수 없습니다....
2025-06-08 13:13:33,597 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1611 - No speech segments found for bill '94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 2208268)', trying ◯ fallback
2025-06-08 13:13:33,597 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1647 - 🔍 Stage 2 (◯ Splitting): For bill '94. AI 디지털교과서 도입과정에 대한 감사원 감사요구안(교육위원장 제출)(의안번호 2208268)' (session: 54810) - 577 chars
2025-06-08 13:13:33,597 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1658 - No ◯ markers found, skipping segment
2025-06-08 13:13:34,597 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509) (577 chars) ---
2025-06-08 13:13:34,598 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509)' (session: 54810) - 577 chars
2025-06-08 13:13:34,598 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2...' (577 chars)
2025-06-08 13:13:34,858 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1611 - No speech segments found for bill '93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509)', trying ◯ fallback
2025-06-08 13:13:34,858 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1647 - 🔍 Stage 2 (◯ Splitting): For bill '93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509)' (session: 54810) - 577 chars
2025-06-08 13:13:34,859 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1677 - Split text into 0 individual speech segments based on ◯ markers. Segment sizes: [] chars
2025-06-08 13:13:34,859 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1685 - ✅ ◯-based processing for '93. 환경기술 및 환경산업 지원법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208509)' resulted in 0 statements from 0 speech segments
2025-06-08 13:13:35,859 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안번호 2203760) (577 chars) ---
2025-06-08 13:13:35,859 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안번호 2203760)' (session: 54810) - 577 chars
2025-06-08 13:13:35,859 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안...' (577 chars)
2025-06-08 13:13:36,138 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1611 - No speech segments found for bill '92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안번호 2203760)', trying ◯ fallback
2025-06-08 13:13:36,138 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1647 - 🔍 Stage 2 (◯ Splitting): For bill '92. 화학물질의 등록 및 평가 등에 관한 법률 일부개정법률안(박홍배 의원 대표발의)(의안번호 2203760)' (session: 54810) - 577 chars
2025-06-08 13:13:36,138 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1658 - No ◯ markers found, skipping segment
2025-06-08 13:13:37,139 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 91. 폐기물관리법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208508) (577 chars) ---
2025-06-08 13:13:37,139 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '91. 폐기물관리법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208508)' (session: 54810) - 577 chars
2025-06-08 13:13:37,139 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '91. 폐기물관리법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208508)...' (577 chars)
2025-06-08 13:13:37,382 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1611 - No speech segments found for bill '91. 폐기물관리법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208508)', trying ◯ fallback
2025-06-08 13:13:37,383 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1647 - 🔍 Stage 2 (◯ Splitting): For bill '91. 폐기물관리법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208508)' (session: 54810) - 577 chars
2025-06-08 13:13:37,385 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1658 - No ◯ markers found, skipping segment
2025-06-08 13:13:38,385 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653) (577 chars) ---
2025-06-08 13:13:38,386 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653)' (session: 54810) - 577 chars
2025-06-08 13:13:38,386 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653)...' (577 chars)
2025-06-08 13:13:38,757 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1630 - Extracted 1 speech segments using LLM indices
2025-06-08 13:13:38,757 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1706 - 🚀 Processing 1 speech segments in parallel batch for bill '90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653)'
2025-06-08 13:13:38,757 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2099 - 🚀 Batch analyzing 1 speech segments for bill '90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653)...' using gemini-2.0-flash-lite
2025-06-08 13:13:38,822 - api.tasks - INFO - tasks - get_all_assembly_members - 1564 - ✅ Using 0 assembly member names from local database
2025-06-08 13:13:38,822 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2121 - Processing batch 1/1: segments 0-0
2025-06-08 13:13:39,518 - api.tasks - INFO - tasks - _execute_batch_analysis - 2285 - Batch processing took 0.7s for 1 segments
2025-06-08 13:13:39,519 - api.tasks - INFO - tasks - _execute_batch_analysis - 2357 - ✅ Batch processed 0 valid statements from 1 segments
2025-06-08 13:13:39,519 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2151 - ✅ Batch analysis completed: 0 valid statements from 1 segments
2025-06-08 13:13:39,519 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1714 - 🎉 Parallel batch processing completed for '90. 토양환경보전법 일부개정법률안(김위상 의원 대표발의)(의안번호 2202653)': 0 valid statements from 1 segments
2025-06-08 13:13:40,519 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정에 관한 법률안(김형동 의원 대표발의)(의안번호 2203548) (577 chars) ---
2025-06-08 13:13:40,519 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정에 관한 법률안(김형동 의원 대표발의)(의안번호 2203548)' (session: 54810) - 577 chars
2025-06-08 13:13:40,520 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정...' (577 chars)
2025-06-08 13:13:40,894 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1630 - Extracted 1 speech segments using LLM indices
2025-06-08 13:13:40,894 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1706 - 🚀 Processing 1 speech segments in parallel batch for bill '89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정에 관한 법률안(김형동 의원 대표발의)(의안번호 2203548)'
2025-06-08 13:13:40,894 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2099 - 🚀 Batch analyzing 1 speech segments for bill '89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정...' using gemini-2.0-flash-lite
2025-06-08 13:13:40,938 - api.tasks - INFO - tasks - get_all_assembly_members - 1564 - ✅ Using 0 assembly member names from local database
2025-06-08 13:13:40,938 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2121 - Processing batch 1/1: segments 0-0
2025-06-08 13:13:41,633 - api.tasks - INFO - tasks - _execute_batch_analysis - 2285 - Batch processing took 0.7s for 1 segments
2025-06-08 13:13:41,634 - api.tasks - INFO - tasks - _execute_batch_analysis - 2357 - ✅ Batch processed 1 valid statements from 1 segments
2025-06-08 13:13:41,634 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2151 - ✅ Batch analysis completed: 1 valid statements from 1 segments
2025-06-08 13:13:41,634 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1714 - 🎉 Parallel batch processing completed for '89. 중앙행정권한 및 사무 등의 지방 일괄이양을 위한 폐기물관리법 등 8개 법률 일부개정에 관한 법률안(김형동 의원 대표발의)(의안번호 2203548)': 1 valid statements from 1 segments
2025-06-08 13:13:42,634 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506) (577 chars) ---
2025-06-08 13:13:42,634 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506)' (session: 54810) - 577 chars
2025-06-08 13:13:42,634 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506)...' (577 chars)
2025-06-08 13:13:43,033 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1630 - Extracted 1 speech segments using LLM indices
2025-06-08 13:13:43,033 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1706 - 🚀 Processing 1 speech segments in parallel batch for bill '88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506)'
2025-06-08 13:13:43,033 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2099 - 🚀 Batch analyzing 1 speech segments for bill '88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506)...' using gemini-2.0-flash-lite
2025-06-08 13:13:43,077 - api.tasks - INFO - tasks - get_all_assembly_members - 1564 - ✅ Using 0 assembly member names from local database
2025-06-08 13:13:43,077 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2121 - Processing batch 1/1: segments 0-0
2025-06-08 13:13:44,681 - api.tasks - INFO - tasks - _execute_batch_analysis - 2285 - Batch processing took 1.6s for 1 segments
2025-06-08 13:13:44,682 - api.tasks - INFO - tasks - _execute_batch_analysis - 2357 - ✅ Batch processed 1 valid statements from 1 segments
2025-06-08 13:13:44,682 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2151 - ✅ Batch analysis completed: 1 valid statements from 1 segments
2025-06-08 13:13:44,682 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1714 - 🎉 Parallel batch processing completed for '88. 자연환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208506)': 1 valid statements from 1 segments
2025-06-08 13:13:45,682 - api.tasks - INFO - tasks - process_pdf_text_for_statements - 3265 - --- Processing segment for Bill: 87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502) (577 chars) ---
2025-06-08 13:13:45,682 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1603 - 🔍 Processing bill segment: '87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502)' (session: 54810) - 577 chars
2025-06-08 13:13:45,682 - api.tasks - INFO - tasks - get_speech_segment_indices_from_llm - 1734 - 🎯 Getting speech segment indices for bill '87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502)...' (577 chars)
2025-06-08 13:13:46,130 - api.tasks - INFO - tasks - extract_statements_for_bill_segment - 1630 - Extracted 2 speech segments using LLM indices
2025-06-08 13:13:46,130 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1706 - 🚀 Processing 2 speech segments in parallel batch for bill '87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502)'
2025-06-08 13:13:46,130 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2099 - 🚀 Batch analyzing 2 speech segments for bill '87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502)...' using gemini-2.0-flash-lite
2025-06-08 13:13:46,174 - api.tasks - INFO - tasks - get_all_assembly_members - 1564 - ✅ Using 0 assembly member names from local database
2025-06-08 13:13:46,174 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2121 - Processing batch 1/1: segments 0-1
2025-06-08 13:13:47,454 - api.tasks - INFO - tasks - _execute_batch_analysis - 2285 - Batch processing took 1.3s for 2 segments
2025-06-08 13:13:47,455 - api.tasks - INFO - tasks - _execute_batch_analysis - 2357 - ✅ Batch processed 0 valid statements from 2 segments
2025-06-08 13:13:47,455 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2151 - ✅ Batch analysis completed: 0 valid statements from 2 segments
2025-06-08 13:13:47,455 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1714 - 🎉 Parallel batch processing completed for '87. 대기환경보전법 일부개정법률안(대안)(환경노동위원장 제출)(의안번호 2208502)': 0 valid statements from 2 segments
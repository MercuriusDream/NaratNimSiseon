--- Processing session 54810 (1/2) ---
📄 Title: 제22대 제426회 제1차 국회본회의 (2025년 06월 05일)
📥 Downloading PDF from: https://record.assembly.go.kr/assembly/viewer/minutes/download/pdf.do?id=54810
✅ PDF downloaded: temp_files/session_54810_1749570071.pdf
📄 Extracting text from PDF...
📖 Processing 46 pages...
📄 Processed 20/46 pages...
📄 Processed 40/46 pages...
✅ Extracted 54281 characters
🤖 Processing with LLM...
📋 Bills context: 95 bills found
2025-06-10 15:41:23,656 - api.tasks - INFO - tasks - process_session_pdf_text - 4106 - 🔄 Processing PDF text for session 54810 (54281 chars)
2025-06-10 15:41:23,657 - api.tasks - INFO - tasks - clean_pdf_text - 4172 - 📖 Isolated discussion block of 9043 chars (from original 54281).
2025-06-10 15:41:23,657 - api.tasks - INFO - tasks - clean_pdf_text - 4197 - 🧹 Text cleaning complete. Final length: 8960
2025-06-10 15:41:23,658 - api.tasks - INFO - tasks - extract_statements_with_llm_discovery - 2789 - 🤖 Starting LLM discovery and segmentation for session: 54810
2025-06-10 15:41:32,154 - api.tasks - INFO - tasks - extract_statements_with_llm_discovery - 2933 - 🐛 DEBUG: Raw LLM response length: 0 chars
2025-06-10 15:41:32,154 - api.tasks - INFO - tasks - extract_statements_with_llm_discovery - 2934 - 🐛 DEBUG: Raw LLM response (first 1000 chars): 
2025-06-10 15:41:32,154 - api.tasks - ERROR - tasks - extract_statements_with_llm_discovery - 2940 - ❌ Empty response from LLM discovery. Falling back to keyword extraction.
2025-06-10 15:41:32,154 - api.tasks - INFO - tasks - extract_statements_with_keyword_fallback - 3352 - 🔍 Using keyword-based fallback extraction for session 54810
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - extract_statements_with_keyword_fallback - 3381 - Found 4 potential bill sections using keywords
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1896 - 🔍 Stage 2 (◯ Splitting): For bill '2. 순직 해병 수사 방해 및 사건 은폐 등의 진상규명을 위한 특별검사의 임명 등에 관한' (session: 54810) - 95 chars
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1907 - No ◯ markers found, skipping segment
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1896 - 🔍 Stage 2 (◯ Splitting): For bill '3. 윤석열 전 대통령 등에 의한 내란·외환 행위의 진상규명을 위한 특별검사 임명 등에' (session: 54810) - 97 chars
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1907 - No ◯ markers found, skipping segment
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1896 - 🔍 Stage 2 (◯ Splitting): For bill '4. 김건희와 명태균·건진법사 관련 국정농단 및 불법 선거 개입 사건 등 진상규명을 위한' (session: 54810) - 109 chars
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1907 - No ◯ markers found, skipping segment
2025-06-10 15:41:32,155 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1896 - 🔍 Stage 2 (◯ Splitting): For bill '◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희' (session: 54810) - 7147 chars
2025-06-10 15:41:32,156 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1926 - Split text into 9 individual speech segments based on ◯ markers. Segment sizes: [161, 1263, 113, 1805, 54, 1777, 582, 555, 806] chars
2025-06-10 15:41:32,156 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1955 - 🚀 Processing 9 speech segments in parallel batch for bill '◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희'
2025-06-10 15:41:32,156 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2251 - 🚀 Batch analyzing 9 speech segments for bill '◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희...' using gemini-2.0-flash
2025-06-10 15:41:32,457 - api.tasks - INFO - tasks - get_all_assembly_members - 1806 - ✅ Using 3022 assembly member names from local database
2025-06-10 15:41:32,457 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2266 - Processing batch 1/1: segments 0-8
2025-06-10 15:41:34,781 - api.tasks - INFO - tasks - _execute_batch_analysis - 2462 - Batch processing took 2.3s for 9 segments
2025-06-10 15:41:34,835 - api.tasks - INFO - tasks - _execute_batch_analysis - 2585 - ✅ Batch processed 8 valid statements from 9 segments
2025-06-10 15:41:34,835 - api.tasks - INFO - tasks - analyze_speech_segment_with_llm_batch - 2304 - ✅ Batch analysis completed: 8 valid statements from 9 segments
2025-06-10 15:41:34,836 - api.tasks - INFO - tasks - process_speech_segments_multithreaded - 1963 - 🎉 Parallel batch processing completed for '◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희': 8 valid statements from 9 segments
2025-06-10 15:41:34,836 - api.tasks - INFO - tasks - process_single_segment_for_statements_with_splitting - 1934 - ✅ ◯-based processing for '◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희' resulted in 8 statements from 9 speech segments
2025-06-10 15:41:34,836 - api.tasks - INFO - tasks - extract_statements_with_keyword_fallback - 3412 - ✅ Keyword-based extraction completed: 8 statements
2025-06-10 15:41:34,836 - api.tasks - INFO - tasks - process_session_pdf_text - 4126 - ✅ Extracted 8 statements in total for session 54810
2025-06-10 15:41:34,836 - api.tasks - INFO - tasks - process_extracted_statements_data - 3182 - Attempting to save 8 statements for session 54810.
2025-06-10 15:41:34,836 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1405]: 1404 chars
2025-06-10 15:41:35,074 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 박범계
2025-06-10 15:41:35,075 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "segment_index": 0,
  "speaker_name": "박범계",
  "start_idx": 1,
  "end_idx": 1405,
  "is_valid_member": true,
  "is_substantial": true,
  "sentiment_score": -0.1,
  "bill_relevance_score": 0.9,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:35,075 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:35,077 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1405]: 1404 chars
2025-06-10 15:41:35,305 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 박범계
2025-06-10 15:41:35,305 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "speaker_name": "박범계",
  "start_idx": 1,
  "end_idx": 1405,
  "sentiment_score": -0.1,
  "sentiment_reason": "LLM 배치 분석 완료",
  "bill_relevance_score": 0.9,
  "policy_categories": [],
  "policy_keywords": [],
  "bill_specific_keywords": [],
  "segment_index": 0,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:35,305 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:35,306 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1143]: 1142 chars
2025-06-10 15:41:35,534 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 주진우
2025-06-10 15:41:35,535 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "segment_index": 1,
  "speaker_name": "주진우",
  "start_idx": 1,
  "end_idx": 1143,
  "is_valid_member": true,
  "is_substantial": true,
  "sentiment_score": -0.3,
  "bill_relevance_score": 0.8,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:35,535 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:35,535 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1143]: 1142 chars
2025-06-10 15:41:35,764 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 주진우
2025-06-10 15:41:35,764 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "speaker_name": "주진우",
  "start_idx": 1,
  "end_idx": 1143,
  "sentiment_score": -0.3,
  "sentiment_reason": "LLM 배치 분석 완료",
  "bill_relevance_score": 0.8,
  "policy_categories": [],
  "policy_keywords": [],
  "bill_specific_keywords": [],
  "segment_index": 1,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:35,764 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:35,764 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1021]: 1019 chars
2025-06-10 15:41:35,992 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 김용민
2025-06-10 15:41:35,993 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "segment_index": 2,
  "speaker_name": "김용민",
  "start_idx": 1,
  "end_idx": 1021,
  "is_valid_member": true,
  "is_substantial": true,
  "sentiment_score": 0.4,
  "bill_relevance_score": 0.9,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:35,993 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:35,993 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:1021]: 1019 chars
2025-06-10 15:41:36,222 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 김용민
2025-06-10 15:41:36,222 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "speaker_name": "김용민",
  "start_idx": 1,
  "end_idx": 1021,
  "sentiment_score": 0.4,
  "sentiment_reason": "LLM 배치 분석 완료",
  "bill_relevance_score": 0.9,
  "policy_categories": [],
  "policy_keywords": [],
  "bill_specific_keywords": [],
  "segment_index": 2,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:36,222 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:36,223 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:610]: 609 chars
2025-06-10 15:41:36,451 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 박성준
2025-06-10 15:41:36,451 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "segment_index": 3,
  "speaker_name": "박성준",
  "start_idx": 1,
  "end_idx": 610,
  "is_valid_member": true,
  "is_substantial": true,
  "sentiment_score": 0.2,
  "bill_relevance_score": 0.9,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:36,451 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:36,452 - api.tasks - DEBUG - tasks - process_extracted_statements_data - 3198 - Extracted text from indices [1:610]: 609 chars
2025-06-10 15:41:36,683 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3330 - ❌ Error creating statement object in DB: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json' for speaker 박성준
2025-06-10 15:41:36,684 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3333 - Failing statement data: {
  "speaker_name": "박성준",
  "start_idx": 1,
  "end_idx": 610,
  "sentiment_score": 0.2,
  "sentiment_reason": "LLM 배치 분석 완료",
  "bill_relevance_score": 0.9,
  "policy_categories": [],
  "policy_keywords": [],
  "bill_specific_keywords": [],
  "segment_index": 3,
  "associated_bill_name": "◯의장 우원식 의사일정 제1항 검사징계법 일부개정법률안부터 의사일정 제4항 김건희"
}
2025-06-10 15:41:36,684 - api.tasks - ERROR - tasks - process_extracted_statements_data - 3336 - Traceback for statement save error:
Traceback (most recent call last):
  File "/home/runner/workspace/backend/api/tasks.py", line 3297, in process_extracted_statements_data
    new_statement = Statement(
                    ^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.12/site-packages/django/db/models/base.py", line 567, in __init__
    raise TypeError(
TypeError: Statement() got unexpected keyword arguments: 'category_analysis', 'policy_keywords', 'bill_specific_keywords_json'
2025-06-10 15:41:36,685 - api.tasks - INFO - tasks - process_extracted_statements_data - 3339 - 🎉 Saved 0 new statements for session 54810.
✅ LLM processing completed
🗑️ Cleaned up temporary PDF file